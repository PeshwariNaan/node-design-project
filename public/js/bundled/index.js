!function(){function e(e,t,n,r,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,a){var s=t.apply(n,r);function u(t){e(s,o,a,u,c,"next",t)}function c(t){e(s,o,a,u,c,"throw",t)}u(void 0)}))}}function n(e,t){var n,r,o,a,s=function(e){return function(t){return u([e,t])}},u=function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){c.label=s[1];break}if(6===s[0]&&c.label<o[1]){c.label=o[1],o=s;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(s);break}o[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}},c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}Object.create;Object.create;var r,o=function(){var e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;o();var r='<div class="alert alert--'.concat(e,'">').concat(t,"</div>");document.querySelector("body").insertAdjacentHTML("afterbegin",r),window.setTimeout(o,1e3*n)},s=(r=t((function(e,t){var r;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,axios({method:"POST",url:"/api/v1/users/login",data:{email:e,password:t}})];case 1:return"success"===n.sent().data.status&&(a("success","Logged in successfully"),window.setTimeout((function(){location.assign("/")}),1500)),[3,3];case 2:return r=n.sent(),a("error",r.response.data.message),[3,3];case 3:return[2]}}))})),function(e,t){return r.apply(this,arguments)}),u=function(){var e=t((function(){var e;return n(this,(function(t){switch(t.label){case 0:console.log("The logout has been pushed"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,axios({method:"GET",url:"/api/v1/users/logout"})];case 2:return t.sent().data.status="success",location.reload(!0),[3,4];case 3:return e=t.sent(),console.log(e.response),a("error","Error logging out! Try again."),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),c=function(){var e=t((function(e,t){var r;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,axios({method:"PATCH",url:"password"===t?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe",data:e})];case 1:return"success"===n.sent().data.status&&a("success","".concat(t.toUpperCase()," updated successfully!")),[3,3];case 2:return r=n.sent(),a("error",r.response.data.message),[3,3];case 3:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),i="https://js.stripe.com/v3",l=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,d="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",p=null,m=function(e){return null!==p||(p=new Promise((function(t,n){if("undefined"!=typeof window)if(window.Stripe&&e&&console.warn(d),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(i,'"]')),t=0;t<e.length;t++){var n=e[t];if(l.test(n.src))return n}return null}();r&&e?console.warn(d):r||(r=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(i).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(e)),r.addEventListener("load",(function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(e){return void n(e)}else t(null)}))),p},f=function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.46.0",startTime:t})}(r,n),r},v=Promise.resolve().then((function(){return m(null)})),w=!1;v.catch((function(e){w||console.warn(e)}));var y=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w=!0;var r=Date.now();return v.then((function(e){return f(e,t,r)}))},h=function(){var e=t((function(e){var t,r;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,y("pk_test_51L5OEPK5Vz0ZWlMoOsjCUEFVKVxX1q2GLsKPpe0otCAl7AwZiJh6AS1JQoFMRsU0v1DY5tSDNl0Gh9pmVeoRwL5Z00F1nqDUbq")];case 1:return n.sent(),[4,axios("/api/v1/bookings/checkout-session/".concat(e))];case 2:return t=n.sent(),window.location.replace(t.data.session.url),[3,4];case 3:return r=n.sent(),console.log(r),a("error",r),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),g=document.getElementById("map"),b=document.querySelector(".form--login"),E=document.querySelector(".nav__el--logout"),S=document.querySelector(".form-user-data"),x=document.querySelector(".form-user-password"),L=document.getElementById("book-tour");if(g){var I=JSON.parse(g.dataset.locations);console.log(I),function(e){mapboxgl.accessToken="pk.eyJ1IjoicGVzaHdhcmluYWFuIiwiYSI6ImNsZHltc3hzMTBlbWczdW53d2MydXN0a2cifQ.fi--XA37Ab73fzBEZb7g8Q";var t=new mapboxgl.Map({container:"map",style:"mapbox://styles/peshwarinaan/cldyq4yrh007r01plcrldnsq6",scrollZoom:!1}),n=new mapboxgl.LngLatBounds;e.forEach((function(e){var r=document.createElement("div");r.className="marker",new mapboxgl.Marker({element:r,anchor:"bottom"}).setLngLat(e.coordinates).addTo(t),new mapboxgl.Popup({offset:30}).setLngLat(e.coordinates).setHTML("<p>Day ".concat(e.day,": ").concat(e.description,"</p>")).addTo(t),n.extend(e.coordinates)})),t.fitBounds(n,{padding:{top:200,bottom:150,left:100,right:100}})}(I)}b&&b.addEventListener("submit",(function(e){e.preventDefault();var t=document.getElementById("email").value,n=document.getElementById("password").value;s(t,n)})),E&&E.addEventListener("click",u),S&&S.addEventListener("submit",(function(e){e.preventDefault();var t=new FormData;t.append("name",document.getElementById("name").value),t.append("email",document.getElementById("email").value),t.append("photo",document.getElementById("photo").files[0]),c(t,"data")})),x&&x.addEventListener("submit",function(){var e=t((function(e){var t,r,o;return n(this,(function(n){switch(n.label){case 0:return e.preventDefault(),document.querySelector(".btn--save-password").textContent="Updating...",t=document.getElementById("password-current").value,r=document.getElementById("password").value,o=document.getElementById("password-confirm").value,[4,c({passwordCurrent:t,password:r,passwordConfirm:o},"password")];case 1:return n.sent(),document.querySelector(".btn--save-password").textContent="Save Password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value="",[2]}}))}));return function(t){return e.apply(this,arguments)}}()),L&&L.addEventListener("click",(function(e){e.target.textContent="Processing...";var t=e.target.dataset.tourId;h(t)}));var B=document.querySelector("body").dataset.alert;B&&a("success",B,10)}();
//# sourceMappingURL=index.js.map
